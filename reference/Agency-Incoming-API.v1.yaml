openapi: 3.0.0
info:
  title: Agency Incoming API
  version: '1.0'
  description: API spec for agencies to process incoming requests from Freede.
servers: []
paths:
  /intent/communication:
    post:
      summary: Agency confirmation of intent to communicate with consumer
      tags:
        - Intents
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  allowed:
                    type: boolean
                required:
                  - allowed
        '401':
          description: Unauthorized
      operationId: post-intent-communication
      description: ''
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: Intent ID
                consumer_ref:
                  type: string
                  description: Consumer Reference
                method:
                  type: integer
                  description: '0 = Email, 1 = SMS, 2 = Popup'
                  enum:
                    - 0
                    - 1
                    - 2
                type:
                  type: integer
                  description: |-
                    0 = Registration Confirmation
                    1 = Initial Score
                    2 = Score Change
                    3 = Payment attempt failed, no payment plan
                    4 = Payment attempt failed, payment plan
                    5 = Upcoming payment reminder
                    6 = Repayment offer
                    7 = Increase payment plan
                    8 = Setup Payment (Standard)
                    9 = Setup Payment (Good Place)
                    —— Future Planned ——
                    10 = Deregister
                    11 = Payment applied
                    12 = Payment plan confirmation
                    13 = Payment plan canceled
                    14 = Payment returned
                    15 = Payment refunded
                  minimum: 0
                  maximum: 15
  /registration:
    post:
      summary: Register consumer
      tags:
        - Registration
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Account'
              examples: {}
        '401':
          description: Unauthorized
      operationId: post-registration
      parameters:
        - schema:
            type: string
          in: header
          name: Freede-Verification-Key
          description: SHA256 Hash of Token and API key
        - schema:
            type: string
          in: header
          name: Freede-API-Version
          description: Freede Agency Incoming API Version
        - schema:
            type: string
          in: header
          name: Freede-Verification-Token
          description: Token Salt
      description: Freede will submit this POST request when a consumer is attempting to register with the agency. Agency may perform their own validation checks and return a response.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                first:
                  type: string
                last:
                  type: string
                address:
                  type: string
                address2:
                  type: string
                city:
                  type: string
                state:
                  type: string
                zip:
                  type: string
                phone:
                  type: string
                email:
                  type: string
                  format: email
                regcode:
                  type: string
                verify:
                  type: boolean
                optins:
                  $ref: '#/components/schemas/optins'
              required:
                - regcode
                - verify
            examples:
              example-1:
                value:
                  first: string
                  last: string
                  address: string
                  address2: string
                  city: string
                  state: string
                  zip: string
                  phone: string
                  email: user@example.com
                  regcode: string
                  verify: true
                  optins:
                    sms: true
                    phone: true
                    email: true
                    push: true
                    default: string
        description: Consumer registration information
  '/account/{accountNum}':
    get:
      summary: Get account details
      tags:
        - Accounts
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Account'
              examples:
                Example:
                  value:
                    type: medical
                    interest_bearing: true
                    ref: string
                    desc: string
                    status_reason: string
                    status: 0
                    balance_current: 0
                    balance_start: 0
                    balance_buckets:
                      - name: string
                        balance_current: 0
                        balance_start: 0
                        type: interest
                    agency:
                      ref: string
                      last_payment_amt: 0
                      last_activity: string
                      last_payment_date: string
                    creditor:
                      ref: string
                      last_payment_amt: 0
                      last_activity: string
                      last_payment_date: string
                      name: string
                    consumer:
                      ref: string
        '204':
          description: No Content
      operationId: get-account
      parameters:
        - schema:
            type: string
          in: header
          name: Freede-Verification-Key
          description: SHA256 Hash of Token and API key
        - schema:
            type: string
          in: header
          name: Freede-API-Version
          description: Freede Agency Incoming API Version
        - schema:
            type: string
          in: header
          name: Freede-Verification-Token
          description: Token Salt
      description: Endpoint to get the account details from the agency
    parameters:
      - schema:
          type: string
        name: accountNum
        in: path
        required: true
        description: Agency account number
  '/consumer/{consumerRef}/form':
    post:
      summary: Consumer submitted form
      responses:
        '200':
          description: OK
      operationId: post-forms
      parameters:
        - schema:
            type: string
          in: header
          name: Freede-Verification-Key
          description: SHA256 Hash of Token and API key
        - schema:
            type: string
          in: header
          name: Freede-API-Version
          description: Freede Agency Incoming API Version
        - schema:
            type: string
          in: header
          name: Freede-Verification-Token
          description: Token Salt
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                type:
                  type: string
                  enum:
                    - dispute
                    - attorney
                    - bankruptcy
                form:
                  oneOf:
                    - $ref: '#/components/schemas/DisputeForm'
                    - $ref: '#/components/schemas/AttorneyForm'
                    - $ref: '#/components/schemas/BankruptcyForm'
                tasks:
                  type: array
                  description: 'If provided, use this ID and type to submit back to the Agency API'
                  items:
                    type: object
                    properties:
                      id:
                        type: string
                      type:
                        type: string
                        enum:
                          - proof_of_debt
                consumer_ref:
                  type: string
                  description: Agency consumer ref
            examples:
              Dispute example:
                value:
                  type: dispute
                  form:
                    amount: 0
                    reason: string
                    bankruptcy:
                      chapter: string
                      filing_date: '2019-08-24'
                      discharge_date: '2019-08-24'
                      case_number: string
                      district_court: string
                    attorney:
                      name: string
                      lawfirm: string
                      phone: string
                      fax: string
                      email: string
                      website: string
                      address1: string
                      address2: string
                      address3: string
                      city: string
                      state: string
                      zip: string
                    accounts:
                      - string
                    files:
                      - name: string
                        base64: string
                        mime: string
                  tasks:
                    - id: string
                      type: proof_of_debt
                  consumer_ref: string
      description: Endpoint to receive forms consumer has submitted
      tags:
        - Consumers
    parameters:
      - schema:
          type: string
        name: consumerRef
        in: path
        required: true
  '/consumer/{consumerRef}':
    parameters:
      - schema:
          type: string
        name: consumerRef
        in: path
        required: true
    put:
      summary: Update consumer demographics
      tags:
        - Consumers
      responses:
        '200':
          description: OK
      operationId: put-consumer-consumerRef
      parameters:
        - schema:
            type: string
          in: header
          name: Freede-Verification-Key
          description: SHA256 Hash of Token and API key
        - schema:
            type: string
          in: header
          name: Freede-API-Version
          description: Freede Agency Incoming API Version
        - schema:
            type: string
          in: header
          name: Freede-Verification-Token
          description: Token Salt
      requestBody:
        content:
          application/json:
            schema:
              description: ''
              type: object
              x-examples:
                example-1:
                  first: string
                  last: string
                  address: string
                  address2: string
                  city: string
                  state: string
                  zip: string
                  email: string
                  phone: string
                  ref: string
              properties:
                first:
                  type: string
                  minLength: 1
                last:
                  type: string
                  minLength: 1
                address:
                  type: string
                  minLength: 1
                address2:
                  type: string
                  minLength: 1
                city:
                  type: string
                  minLength: 1
                state:
                  type: string
                  minLength: 1
                zip:
                  type: string
                email:
                  type: string
                  minLength: 1
                phone:
                  type: string
                  minLength: 1
              required:
                - first
                - last
                - address
                - address2
                - city
                - state
                - email
                - phone
            examples:
              Example:
                value:
                  first: string
                  last: string
                  address: string
                  address2: string
                  city: string
                  state: string
                  zip: string
                  email: string
                  phone: string
      description: Endpoint to receive updated consumer demographics
    delete:
      summary: Deregister consumer
      operationId: delete-consumer-consumerRef
      parameters:
        - schema:
            type: string
          in: header
          name: Freede-Verification-Key
          description: SHA256 Hash of Token and API key
        - schema:
            type: string
          in: header
          name: Freede-API-Version
          description: Freede Agency Incoming API Version
        - schema:
            type: string
          in: header
          name: Freede-Verification-Token
          description: Token Salt
      responses:
        '200':
          description: OK
      description: Endpoint to deregister consumer from Freede
      tags:
        - Consumers
  '/consumer/{consumerRef}/optins':
    parameters:
      - schema:
          type: string
        name: consumerRef
        in: path
        required: true
        description: Agency consumer reference
    put:
      summary: Update consumer optins
      tags:
        - Consumers
      responses:
        '200':
          description: OK
      operationId: put-consumer-consumerRef-optins
      parameters:
        - schema:
            type: string
          in: header
          name: Freede-Verification-Key
          description: SHA256 Hash of Token and API key
        - schema:
            type: string
          in: header
          name: Freede-API-Version
          description: Freede Agency Incoming API Version
        - schema:
            type: string
          in: header
          name: Freede-Verification-Token
          description: Token Salt
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/optins'
            examples:
              Example:
                value:
                  sms: true
                  phone: true
                  email: true
                  push: true
                  esign: true
                  default: string
      description: Endpoint to receive updated consumer optins
  '/consumer/{consumerRef}/conversation':
    parameters:
      - schema:
          type: string
        name: consumerRef
        in: path
        required: true
    post:
      summary: Consumer conversation
      tags:
        - Consumers
      responses:
        '200':
          description: OK
      operationId: post-consumer-consumerRef-conversation
      parameters:
        - schema:
            type: string
          in: header
          name: Freede-Verification-Key
          description: SHA256 Hash of Token and API key
        - schema:
            type: string
          in: header
          name: Freede-API-Version
          description: Freede Agency Incoming API Version
        - schema:
            type: string
          in: header
          name: Freede-Verification-Token
          description: Token Salt
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Conversation'
            examples:
              Chat Example:
                value:
                  type: chat
                  when: '2019-08-24T14:15:22Z'
                  id: 5fa4c5a7bdb82a9e6e0a9ae9
                  status: open
      description: Endpoint to receive notice of consumer conversation. Can use Id to retrieve conversation details from Agency API
  '/consumer/{consumerRef}/{conversationId}':
    parameters:
      - schema:
          type: string
        name: consumerRef
        in: path
        required: true
      - schema:
          type: string
        name: conversationId
        in: path
        required: true
    put:
      summary: Update consumer conversation
      operationId: put-consumer-consumerRef-conversationId
      responses:
        '200':
          description: OK
      description: Update the status of the consumer conversation
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                when:
                  type: string
                  description: When the status change happened
                  format: date-time
                status:
                  type: string
                  description: Status of the conversation
                  enum:
                    - closed
              required:
                - when
                - status
            examples:
              example-1:
                value:
                  when: '2019-08-24T14:15:22Z'
                  status: closed
      tags:
        - Consumers
  '/account/{accountNum}/payment':
    parameters:
      - schema:
          type: string
        name: accountNum
        in: path
        required: true
    post:
      summary: Account Payment
      tags:
        - Payments
      responses:
        '200':
          description: OK
      operationId: post-account-accountNum-payment
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: Payment ID
                amount:
                  type: number
                  description: Amount consumer paid
                when:
                  type: string
                  description: When the consumer submitted payment
                  format: date-time
                consumer_ref:
                  type: string
                  description: Consumer reference
                method:
                  type: string
                  enum:
                    - bank
                    - card
                  description: Method of payment
                status:
                  type: integer
                  description: '0=scheduled,1=pending,2=applied,3=refunded,4=returned,5=canceled'
                scheduled:
                  type: string
                  description: When the payment is scheduled for if it's scheduled
              required:
                - id
                - amount
                - when
                - consumer_ref
                - method
                - status
          application/xml:
            schema:
              type: object
              properties: {}
      description: Consumer has sent a payment for an account
      parameters:
        - schema:
            type: string
          in: header
          name: Freede-Verification-Key
          description: SHA256 Hash of Token and API key
        - schema:
            type: string
          in: header
          name: Freede-API-Version
          description: Freede Agency Incoming API Version
        - schema:
            type: string
          in: header
          name: Freede-Verification-Token
          description: Token Salt
  '/account/{accountNum}/payment/{paymentId}':
    parameters:
      - schema:
          type: string
        name: paymentId
        in: path
        required: true
      - schema:
          type: string
        name: accountNum
        in: path
        required: true
    put:
      summary: Update payment
      tags:
        - Payments
      responses:
        '200':
          description: OK
      operationId: put-account-accountNum-payment-paymentId
      parameters:
        - schema:
            type: string
          in: header
          name: Freede-Verification-Key
          description: SHA256 Hash of Token and API key
        - schema:
            type: string
          in: header
          name: Freede-API-Version
          description: Freede Agency Incoming API Version
        - schema:
            type: string
          in: header
          name: Freede-Verification-Token
          description: Token Salt
      description: Endpoint to update the payment status
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: integer
                  description: '0=scheduled,1=pending,2=applied,3=refunded,4=returned,5=canceled'
                when:
                  type: string
                  description: When the status change happened
                scheduled:
                  type: string
                  description: when the payment is scheduled if it's a scheduled payment
              required:
                - status
                - when
  '/account/{accountNum}/offer':
    parameters:
      - schema:
          type: string
        name: accountNum
        in: path
        required: true
    post:
      summary: Submit settlement offer
      tags:
        - Offers
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                    description: '0 = rejected, 1 = accepted, 2 = counter, 3 = in review'
                    enum:
                      - 0
                      - 1
                      - 2
                      - 3
                  counter:
                    type: number
                  expires:
                    type: string
                    format: date-time
                required:
                  - status
        '401':
          description: Unauthorized
      operationId: post-account-accountNum-offer
      parameters:
        - schema:
            type: string
          in: header
          name: Freede-Verification-Key
          description: SHA256 Hash of Token and API key
        - schema:
            type: string
          in: header
          name: Freede-API-Version
          description: Freede Agency Incoming API Version
        - schema:
            type: string
          in: header
          name: Freede-Verification-Token
          description: Token Salt
      description: Submit account settlement offer
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: Offer Id for reference if there is a manual review.
                amount:
                  type: number
                  description: Amount consumer has offered to settle the account
                task_id:
                  type: string
                  description: Task Id to be used if manual review
                consumer_ref:
                  type: string
                  description: Consumer ref that has submitted this request
              required:
                - id
                - amount
                - task_id
                - consumer_ref
tags:
  - name: Accounts
  - name: Consumers
  - name: Forms
  - name: Registration
components:
  schemas:
    Account:
      description: Agency Account
      type: object
      properties:
        ref:
          type: string
          minLength: 1
          description: Agency account reference number
        desc:
          type: string
          minLength: 1
          description: Agency account description
        status_reason:
          type: string
          minLength: 1
        status:
          type: integer
          minimum: 0
          maximum: 4
          description: '0=active,1=closed paid in full, 2=closed settlement, 3=disputed, 4=pulled'
        balance_current:
          type: number
        balance_start:
          type: number
        balance_buckets:
          type: array
          uniqueItems: true
          minItems: 1
          description: 'List of balance buckets to display. If a bucket is provided and is null or blank, we will not display it. We display the exact value provided, given it is a number with a precision of 2. Any other values will not be processed.'
          items:
            type: object
            properties:
              name:
                type: string
                minLength: 1
              balance_current:
                type: number
              balance_start:
                type: number
              type:
                type: string
                minLength: 1
                enum:
                  - interest
                  - principal
                  - fees
                  - other
            required:
              - name
              - balance_current
              - balance_start
              - type
        agency:
          type: object
          required:
            - ref
          properties:
            ref:
              type: string
              minLength: 1
            last_payment_amt:
              type: number
            last_activity:
              type: string
              minLength: 1
            last_payment_date:
              type: string
              minLength: 1
        creditor:
          type: object
          required:
            - ref
            - name
          properties:
            ref:
              type: string
              minLength: 1
            last_payment_amt:
              type: number
            last_activity:
              type: string
              minLength: 1
            last_payment_date:
              type: string
              minLength: 1
            name:
              type: string
              minLength: 1
        consumer:
          type: object
          required:
            - ref
          properties:
            ref:
              type: string
              minLength: 1
        type:
          type: string
          enum:
            - medical
            - student
        interest_bearing:
          type: boolean
      required:
        - ref
        - status
        - balance_current
        - balance_start
        - agency
        - creditor
        - consumer
        - type
        - interest_bearing
    Attorney:
      description: ''
      type: object
      properties:
        name:
          type: string
          minLength: 1
        lawfirm:
          type: string
          minLength: 1
        phone:
          type: string
          minLength: 1
        fax:
          type: string
          minLength: 1
        email:
          type: string
          minLength: 1
        website:
          type: string
        address1:
          type: string
        address2:
          type: string
        address3:
          type: string
        city:
          type: string
        state:
          type: string
        zip:
          type: string
    Bankruptcy:
      description: ''
      type: object
      properties:
        chapter:
          type: string
        filing_date:
          type: string
          format: date
        discharge_date:
          type: string
          format: date
        case_number:
          type: string
        district_court:
          type: string
    Consumer:
      description: ''
      type: object
      properties:
        first:
          type: string
          minLength: 1
        last:
          type: string
          minLength: 1
        address:
          type: string
          minLength: 1
        address2:
          type: string
          minLength: 1
        city:
          type: string
          minLength: 1
        state:
          type: string
          minLength: 1
        zip:
          type: string
          minLength: 1
        email:
          type: string
          minLength: 1
        phone:
          type: string
          minLength: 1
        ref:
          type: string
          minLength: 1
      x-examples:
        example-1:
          first: string
          last: string
          address: string
          address2: string
          city: string
          state: string
          postal: string
          email: string
          phone: string
          ref: string
    Conversation:
      description: ''
      type: object
      properties:
        type:
          type: string
          minLength: 1
          enum:
            - sms
            - email
            - chat
            - phone
          description: Conversation channel type
        when:
          type: string
          minLength: 1
          format: date-time
          description: Datetime of when the conversation happened
        id:
          type: string
          minLength: 1
          description: Conversation ID
        status:
          type: string
          description: Status of the conversation
          enum:
            - open
            - closed
      required:
        - type
        - when
        - id
        - status
      x-examples:
        Chat Example:
          type: chat
          when: '2019-08-24T14:15:22Z'
          id: 5fa4c5a7bdb82a9e6e0a9ae9
          status: open
    DisputeForm:
      title: DisputeForm
      type: object
      properties:
        amount:
          type: number
        reason:
          type: string
        bankruptcy:
          $ref: '#/components/schemas/Bankruptcy'
        attorney:
          $ref: '#/components/schemas/Attorney'
        accounts:
          type: array
          items:
            type: string
        files:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              base64:
                type: string
              mime:
                type: string
    BankruptcyForm:
      title: Bankruptcy Form
      type: object
      properties:
        reason:
          type: string
        bankruptcy:
          $ref: '#/components/schemas/Bankruptcy'
        attorney:
          $ref: '#/components/schemas/Attorney'
        accounts:
          type: array
          items:
            type: string
        files:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              base64:
                type: string
              mime:
                type: string
    AttorneyForm:
      title: AttorneyForm
      type: object
      properties:
        reason:
          type: string
        attorney:
          $ref: '#/components/schemas/Attorney'
        accounts:
          type: array
          items:
            type: string
        files:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              base64:
                type: string
              mime:
                type: string
    optins:
      title: optins
      type: object
      properties:
        sms:
          type: boolean
        phone:
          type: boolean
        email:
          type: boolean
        push:
          type: boolean
        esign:
          type: boolean
        default:
          type: string
          description: Default mode of communication.
          enum:
            - sms
            - phone
            - email
            - push
